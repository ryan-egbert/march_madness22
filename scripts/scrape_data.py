ids = [{'id': '91', 'name': 'Bellarmine Knights'},
 {'id': '2110', 'name': 'Central Arkansas Bears'},
 {'id': '2198', 'name': 'Eastern Kentucky Colonels'},
 {'id': '526', 'name': 'Florida Gulf Coast Eagles'},
 {'id': '294', 'name': 'Jacksonville Dolphins'},
 {'id': '55', 'name': 'Jacksonville State Gamecocks'},
 {'id': '338', 'name': 'Kennesaw State Owls'},
 {'id': '2335', 'name': 'Liberty Flames'},
 {'id': '288', 'name': 'Lipscomb Bisons'},
 {'id': '2453', 'name': 'North Alabama Lions'},
 {'id': '2454', 'name': 'North Florida Ospreys'},
 {'id': '56', 'name': 'Stetson Hatters'},
 {'id': '399', 'name': 'Albany Great Danes'},
 {'id': '2066', 'name': 'Binghamton Bearcats'},
 {'id': '42', 'name': 'Hartford Hawks'},
 {'id': '311', 'name': 'Maine Black Bears'},
 {'id': '2885', 'name': 'NJIT Highlanders'},
 {'id': '160', 'name': 'New Hampshire Wildcats'},
 {'id': '2619', 'name': 'Stony Brook Seawolves'},
 {'id': '2378', 'name': 'UMBC Retrievers'},
 {'id': '2349', 'name': 'UMass Lowell River Hawks'},
 {'id': '261', 'name': 'Vermont Catamounts'},
 {'id': '2132', 'name': 'Cincinnati Bearcats'},
 {'id': '151', 'name': 'East Carolina Pirates'},
 {'id': '248', 'name': 'Houston Cougars'},
 {'id': '235', 'name': 'Memphis Tigers'},
 {'id': '2567', 'name': 'SMU Mustangs'},
 {'id': '58', 'name': 'South Florida Bulls'},
 {'id': '218', 'name': 'Temple Owls'},
 {'id': '2655', 'name': 'Tulane Green Wave'},
 {'id': '202', 'name': 'Tulsa Golden Hurricane'},
 {'id': '2116', 'name': 'UCF Knights'},
 {'id': '2724', 'name': 'Wichita State Shockers'},
 {'id': '2166', 'name': 'Davidson Wildcats'},
 {'id': '2168', 'name': 'Dayton Flyers'},
 {'id': '2184', 'name': 'Duquesne Dukes'},
 {'id': '2230', 'name': 'Fordham Rams'},
 {'id': '2244', 'name': 'George Mason Patriots'},
 {'id': '45', 'name': 'George Washington Colonials'},
 {'id': '2325', 'name': 'La Salle Explorers'},
 {'id': '227', 'name': 'Rhode Island Rams'},
 {'id': '257', 'name': 'Richmond Spiders'},
 {'id': '2603', 'name': "Saint Joseph's Hawks"},
 {'id': '139', 'name': 'Saint Louis Billikens'},
 {'id': '179', 'name': 'St. Bonaventure Bonnies'},
 {'id': '113', 'name': 'UMass Minutemen'},
 {'id': '2670', 'name': 'VCU Rams'},
 {'id': '103', 'name': 'Boston College Eagles'},
 {'id': '228', 'name': 'Clemson Tigers'},
 {'id': '150', 'name': 'Duke Blue Devils'},
 {'id': '52', 'name': 'Florida State Seminoles'},
 {'id': '59', 'name': 'Georgia Tech Yellow Jackets'},
 {'id': '97', 'name': 'Louisville Cardinals'},
 {'id': '2390', 'name': 'Miami Hurricanes'},
 {'id': '152', 'name': 'NC State Wolfpack'},
 {'id': '153', 'name': 'North Carolina Tar Heels'},
 {'id': '87', 'name': 'Notre Dame Fighting Irish'},
 {'id': '221', 'name': 'Pittsburgh Panthers'},
 {'id': '183', 'name': 'Syracuse Orange'},
 {'id': '258', 'name': 'Virginia Cavaliers'},
 {'id': '259', 'name': 'Virginia Tech Hokies'},
 {'id': '154', 'name': 'Wake Forest Demon Deacons'},
 {'id': '239', 'name': 'Baylor Bears'},
 {'id': '66', 'name': 'Iowa State Cyclones'},
 {'id': '2305', 'name': 'Kansas Jayhawks'},
 {'id': '2306', 'name': 'Kansas State Wildcats'},
 {'id': '201', 'name': 'Oklahoma Sooners'},
 {'id': '197', 'name': 'Oklahoma State Cowboys'},
 {'id': '2628', 'name': 'TCU Horned Frogs'},
 {'id': '251', 'name': 'Texas Longhorns'},
 {'id': '2641', 'name': 'Texas Tech Red Raiders'},
 {'id': '277', 'name': 'West Virginia Mountaineers'},
 {'id': '2086', 'name': 'Butler Bulldogs'},
 {'id': '156', 'name': 'Creighton Bluejays'},
 {'id': '305', 'name': 'DePaul Blue Demons'},
 {'id': '46', 'name': 'Georgetown Hoyas'},
 {'id': '269', 'name': 'Marquette Golden Eagles'},
 {'id': '2507', 'name': 'Providence Friars'},
 {'id': '2550', 'name': 'Seton Hall Pirates'},
 {'id': '2599', 'name': "St. John's Red Storm"},
 {'id': '41', 'name': 'UConn Huskies'},
 {'id': '222', 'name': 'Villanova Wildcats'},
 {'id': '2752', 'name': 'Xavier Musketeers'},
 {'id': '331', 'name': 'Eastern Washington Eagles'},
 {'id': '304', 'name': 'Idaho State Bengals'},
 {'id': '70', 'name': 'Idaho Vandals'},
 {'id': '149', 'name': 'Montana Grizzlies'},
 {'id': '147', 'name': 'Montana State Bobcats'},
 {'id': '2464', 'name': 'Northern Arizona Lumberjacks'},
 {'id': '2458', 'name': 'Northern Colorado Bears'},
 {'id': '2502', 'name': 'Portland State Vikings'},
 {'id': '16', 'name': 'Sacramento State Hornets'},
 {'id': '253', 'name': 'Southern Utah Thunderbirds'},
 {'id': '2692', 'name': 'Weber State Wildcats'},
 {'id': '2097', 'name': 'Campbell Fighting Camels'},
 {'id': '2127', 'name': 'Charleston Southern Buccaneers'},
 {'id': '2241', 'name': "Gardner-Webb Runnin' Bulldogs"},
 {'id': '2261', 'name': 'Hampton Pirates'},
 {'id': '2272', 'name': 'High Point Panthers'},
 {'id': '2344', 'name': 'Longwood Lancers'},
 {'id': '2448', 'name': 'North Carolina A&T Aggies'},
 {'id': '2506', 'name': 'Presbyterian Blue Hose'},
 {'id': '2515', 'name': 'Radford Highlanders'},
 {'id': '2908', 'name': 'South Carolina Upstate Spartans'},
 {'id': '2427', 'name': 'UNC Asheville Bulldogs'},
 {'id': '2737', 'name': 'Winthrop Eagles'},
 {'id': '356', 'name': 'Illinois Fighting Illini'},
 {'id': '84', 'name': 'Indiana Hoosiers'},
 {'id': '2294', 'name': 'Iowa Hawkeyes'},
 {'id': '120', 'name': 'Maryland Terrapins'},
 {'id': '127', 'name': 'Michigan State Spartans'},
 {'id': '130', 'name': 'Michigan Wolverines'},
 {'id': '135', 'name': 'Minnesota Golden Gophers'},
 {'id': '158', 'name': 'Nebraska Cornhuskers'},
 {'id': '77', 'name': 'Northwestern Wildcats'},
 {'id': '194', 'name': 'Ohio State Buckeyes'},
 {'id': '213', 'name': 'Penn State Nittany Lions'},
 {'id': '2509', 'name': 'Purdue Boilermakers'},
 {'id': '164', 'name': 'Rutgers Scarlet Knights'},
 {'id': '275', 'name': 'Wisconsin Badgers'},
 {'id': '2934', 'name': 'CSU Bakersfield Roadrunners'},
 {'id': '2239', 'name': 'CSU Fullerton Titans'},
 {'id': '2463', 'name': 'CSU Northridge Matadors'},
 {'id': '13', 'name': 'Cal Poly Mustangs'},
 {'id': '62', 'name': "Hawai'i Rainbow Warriors"},
 {'id': '299', 'name': 'Long Beach State Beach'},
 {'id': '302', 'name': 'UC Davis Aggies'},
 {'id': '300', 'name': 'UC Irvine Anteaters'},
 {'id': '27', 'name': 'UC Riverside Highlanders'},
 {'id': '28', 'name': 'UC San Diego Tritons'},
 {'id': '2540', 'name': 'UC Santa Barbara Gauchos'},
 {'id': '232', 'name': 'Charleston Cougars'},
 {'id': '48', 'name': 'Delaware Blue Hens'},
 {'id': '2182', 'name': 'Drexel Dragons'},
 {'id': '2210', 'name': 'Elon Phoenix'},
 {'id': '2275', 'name': 'Hofstra Pride'},
 {'id': '256', 'name': 'James Madison Dukes'},
 {'id': '111', 'name': 'Northeastern Huskies'},
 {'id': '119', 'name': 'Towson Tigers'},
 {'id': '350', 'name': 'UNC Wilmington Seahawks'},
 {'id': '2729', 'name': 'William & Mary Tribe'},
 {'id': '2429', 'name': 'Charlotte 49ers'},
 {'id': '2226', 'name': 'Florida Atlantic Owls'},
 {'id': '2229', 'name': 'Florida International Panthers'},
 {'id': '2348', 'name': 'Louisiana Tech Bulldogs'},
 {'id': '276', 'name': 'Marshall Thundering Herd'},
 {'id': '2393', 'name': 'Middle Tennessee Blue Raiders'},
 {'id': '249', 'name': 'North Texas Mean Green'},
 {'id': '295', 'name': 'Old Dominion Monarchs'},
 {'id': '242', 'name': 'Rice Owls'},
 {'id': '2572', 'name': 'Southern Miss Golden Eagles'},
 {'id': '5', 'name': 'UAB Blazers'},
 {'id': '2638', 'name': 'UTEP Miners'},
 {'id': '2636', 'name': 'UTSA Roadrunners'},
 {'id': '98', 'name': 'Western Kentucky Hilltoppers'},
 {'id': '325', 'name': 'Cleveland State Vikings'},
 {'id': '2174', 'name': 'Detroit Mercy Titans'},
 {'id': '2739', 'name': 'Green Bay Phoenix'},
 {'id': '85', 'name': 'IUPUI Jaguars'},
 {'id': '270', 'name': 'Milwaukee Panthers'},
 {'id': '94', 'name': 'Northern Kentucky Norse'},
 {'id': '2473', 'name': 'Oakland Golden Grizzlies'},
 {'id': '2870', 'name': 'Purdue Fort Wayne Mastodons'},
 {'id': '2523', 'name': 'Robert Morris Colonials'},
 {'id': '82', 'name': 'UIC Flames'},
 {'id': '2750', 'name': 'Wright State Raiders'},
 {'id': '2754', 'name': 'Youngstown State Penguins'},
 {'id': '225', 'name': 'Brown Bears'},
 {'id': '171', 'name': 'Columbia Lions'},
 {'id': '172', 'name': 'Cornell Big Red'},
 {'id': '159', 'name': 'Dartmouth Big Green'},
 {'id': '108', 'name': 'Harvard Crimson'},
 {'id': '219', 'name': 'Pennsylvania Quakers'},
 {'id': '163', 'name': 'Princeton Tigers'},
 {'id': '43', 'name': 'Yale Bulldogs'},
 {'id': '2099', 'name': 'Canisius Golden Griffins'},
 {'id': '2217', 'name': 'Fairfield Stags'},
 {'id': '314', 'name': 'Iona Gaels'},
 {'id': '2363', 'name': 'Manhattan Jaspers'},
 {'id': '2368', 'name': 'Marist Red Foxes'},
 {'id': '2405', 'name': 'Monmouth Hawks'},
 {'id': '315', 'name': 'Niagara Purple Eagles'},
 {'id': '2514', 'name': 'Quinnipiac Bobcats'},
 {'id': '2520', 'name': 'Rider Broncs'},
 {'id': '2612', 'name': "Saint Peter's Peacocks"},
 {'id': '2561', 'name': 'Siena Saints'},
 {'id': '2006', 'name': 'Akron Zips'},
 {'id': '2050', 'name': 'Ball State Cardinals'},
 {'id': '189', 'name': 'Bowling Green Falcons'},
 {'id': '2084', 'name': 'Buffalo Bulls'},
 {'id': '2117', 'name': 'Central Michigan Chippewas'},
 {'id': '2199', 'name': 'Eastern Michigan Eagles'},
 {'id': '2309', 'name': 'Kent State Golden Flashes'},
 {'id': '193', 'name': 'Miami (OH) Redhawks'},
 {'id': '2459', 'name': 'Northern Illinois Huskies'},
 {'id': '195', 'name': 'Ohio Bobcats'},
 {'id': '2649', 'name': 'Toledo Rockets'},
 {'id': '2711', 'name': 'Western Michigan Broncos'},
 {'id': '2154', 'name': 'Coppin State Eagles'},
 {'id': '2169', 'name': 'Delaware State Hornets'},
 {'id': '47', 'name': 'Howard Bison'},
 {'id': '2379', 'name': 'Maryland-Eastern Shore Hawks'},
 {'id': '2415', 'name': 'Morgan State Bears'},
 {'id': '2450', 'name': 'Norfolk State Spartans'},
 {'id': '2428', 'name': 'North Carolina Central Eagles'},
 {'id': '2569', 'name': 'South Carolina State Bulldogs'},
 {'id': '71', 'name': 'Bradley Braves'},
 {'id': '2181', 'name': 'Drake Bulldogs'},
 {'id': '339', 'name': 'Evansville Purple Aces'},
 {'id': '2287', 'name': 'Illinois State Redbirds'},
 {'id': '282', 'name': 'Indiana State Sycamores'},
 {'id': '2350', 'name': 'Loyola Chicago Ramblers'},
 {'id': '2623', 'name': 'Missouri State Bears'},
 {'id': '2460', 'name': 'Northern Iowa Panthers'},
 {'id': '79', 'name': 'Southern Illinois Salukis'},
 {'id': '2674', 'name': 'Valparaiso Beacons'},
 {'id': '2005', 'name': 'Air Force Falcons'},
 {'id': '68', 'name': 'Boise State Broncos'},
 {'id': '36', 'name': 'Colorado State Rams'},
 {'id': '278', 'name': 'Fresno State Bulldogs'},
 {'id': '2440', 'name': 'Nevada Wolf Pack'},
 {'id': '167', 'name': 'New Mexico Lobos'},
 {'id': '21', 'name': 'San Diego State Aztecs'},
 {'id': '23', 'name': 'San JosÃ© State Spartans'},
 {'id': '2439', 'name': 'UNLV Rebels'},
 {'id': '328', 'name': 'Utah State Aggies'},
 {'id': '2751', 'name': 'Wyoming Cowboys'},
 {'id': '2803', 'name': 'Bryant Bulldogs'},
 {'id': '2115', 'name': 'Central Connecticut Blue Devils'},
 {'id': '161', 'name': 'Fairleigh Dickinson Knights'},
 {'id': '112358', 'name': 'Long Island University Sharks'},
 {'id': '2771', 'name': 'Merrimack Warriors'},
 {'id': '116', 'name': "Mount St. Mary's Mountaineers"},
 {'id': '2529', 'name': 'Sacred Heart Pioneers'},
 {'id': '2597', 'name': 'St. Francis (BKN) Terriers'},
 {'id': '2598', 'name': 'St. Francis (PA) Red Flash'},
 {'id': '2681', 'name': 'Wagner Seahawks'},
 {'id': '2046', 'name': 'Austin Peay Governors'},
 {'id': '2057', 'name': 'Belmont Bruins'},
 {'id': '2197', 'name': 'Eastern Illinois Panthers'},
 {'id': '2413', 'name': 'Morehead State Eagles'},
 {'id': '93', 'name': 'Murray State Racers'},
 {'id': '2565', 'name': 'SIU Edwardsville Cougars'},
 {'id': '2546', 'name': 'Southeast Missouri State Redhawks'},
 {'id': '2634', 'name': 'Tennessee State Tigers'},
 {'id': '2635', 'name': 'Tennessee Tech Golden Eagles'},
 {'id': '2630', 'name': 'UT Martin Skyhawks'},
 {'id': '9', 'name': 'Arizona State Sun Devils'},
 {'id': '12', 'name': 'Arizona Wildcats'},
 {'id': '25', 'name': 'California Golden Bears'},
 {'id': '38', 'name': 'Colorado Buffaloes'},
 {'id': '2483', 'name': 'Oregon Ducks'},
 {'id': '204', 'name': 'Oregon State Beavers'},
 {'id': '24', 'name': 'Stanford Cardinal'},
 {'id': '26', 'name': 'UCLA Bruins'},
 {'id': '30', 'name': 'USC Trojans'},
 {'id': '254', 'name': 'Utah Utes'},
 {'id': '264', 'name': 'Washington Huskies'},
 {'id': '265', 'name': 'Washington State Cougars'},
 {'id': '44', 'name': 'American University Eagles'},
 {'id': '349', 'name': 'Army Black Knights'},
 {'id': '104', 'name': 'Boston University Terriers'},
 {'id': '2083', 'name': 'Bucknell Bison'},
 {'id': '2142', 'name': 'Colgate Raiders'},
 {'id': '107', 'name': 'Holy Cross Crusaders'},
 {'id': '322', 'name': 'Lafayette Leopards'},
 {'id': '2329', 'name': 'Lehigh Mountain Hawks'},
 {'id': '2352', 'name': 'Loyola (MD) Greyhounds'},
 {'id': '2426', 'name': 'Navy Midshipmen'},
 {'id': '333', 'name': 'Alabama Crimson Tide'},
 {'id': '8', 'name': 'Arkansas Razorbacks'},
 {'id': '2', 'name': 'Auburn Tigers'},
 {'id': '57', 'name': 'Florida Gators'},
 {'id': '61', 'name': 'Georgia Bulldogs'},
 {'id': '96', 'name': 'Kentucky Wildcats'},
 {'id': '99', 'name': 'LSU Tigers'},
 {'id': '344', 'name': 'Mississippi State Bulldogs'},
 {'id': '142', 'name': 'Missouri Tigers'},
 {'id': '145', 'name': 'Ole Miss Rebels'},
 {'id': '2579', 'name': 'South Carolina Gamecocks'},
 {'id': '2633', 'name': 'Tennessee Volunteers'},
 {'id': '245', 'name': 'Texas A&M Aggies'},
 {'id': '238', 'name': 'Vanderbilt Commodores'},
 {'id': '236', 'name': 'Chattanooga Mocs'},
 {'id': '2193', 'name': 'East Tennessee State Buccaneers'},
 {'id': '231', 'name': 'Furman Paladins'},
 {'id': '2382', 'name': 'Mercer Bears'},
 {'id': '2535', 'name': 'Samford Bulldogs'},
 {'id': '2643', 'name': 'The Citadel Bulldogs'},
 {'id': '2430', 'name': 'UNC Greensboro Spartans'},
 {'id': '2678', 'name': 'VMI Keydets'},
 {'id': '2717', 'name': 'Western Carolina Catamounts'},
 {'id': '2747', 'name': 'Wofford Terriers'},
 {'id': '2277', 'name': 'Houston Baptist Huskies'},
 {'id': '2916', 'name': 'Incarnate Word Cardinals'},
 {'id': '2377', 'name': 'McNeese Cowboys'},
 {'id': '2443', 'name': 'New Orleans Privateers'},
 {'id': '2447', 'name': 'Nicholls Colonels'},
 {'id': '2466', 'name': 'Northwestern State Demons'},
 {'id': '2545', 'name': 'SE Louisiana Lions'},
 {'id': '357', 'name': 'Texas A&M-CC Islanders'},
 {'id': '2010', 'name': 'Alabama A&M Bulldogs'},
 {'id': '2011', 'name': 'Alabama State Hornets'},
 {'id': '2016', 'name': 'Alcorn State Braves'},
 {'id': '2029', 'name': 'Arkansas-Pine Bluff Golden Lions'},
 {'id': '2065', 'name': 'Bethune-Cookman Wildcats'},
 {'id': '50', 'name': 'Florida A&M Rattlers'},
 {'id': '2755', 'name': 'Grambling Tigers'},
 {'id': '2296', 'name': 'Jackson State Tigers'},
 {'id': '2400', 'name': 'Mississippi Valley State Delta Devils'},
 {'id': '2504', 'name': 'Prairie View A&M Panthers'},
 {'id': '2582', 'name': 'Southern Jaguars'},
 {'id': '2640', 'name': 'Texas Southern Tigers'},
 {'id': '2172', 'name': 'Denver Pioneers'},
 {'id': '140', 'name': 'Kansas City Roos'},
 {'id': '155', 'name': 'North Dakota Fighting Hawks'},
 {'id': '2449', 'name': 'North Dakota State Bison'},
 {'id': '2437', 'name': 'Omaha Mavericks'},
 {'id': '198', 'name': 'Oral Roberts Golden Eagles'},
 {'id': '233', 'name': 'South Dakota Coyotes'},
 {'id': '2571', 'name': 'South Dakota State Jackrabbits'},
 {'id': '2900', 'name': 'St. Thomas - Minnesota Tommies'},
 {'id': '2710', 'name': 'Western Illinois Leathernecks'},
 {'id': '2026', 'name': 'Appalachian State Mountaineers'},
 {'id': '2032', 'name': 'Arkansas State Red Wolves'},
 {'id': '324', 'name': 'Coastal Carolina Chanticleers'},
 {'id': '290', 'name': 'Georgia Southern Eagles'},
 {'id': '2247', 'name': 'Georgia State Panthers'},
 {'id': '2031', 'name': 'Little Rock Trojans'},
 {'id': '309', 'name': "Louisiana Ragin' Cajuns"},
 {'id': '6', 'name': 'South Alabama Jaguars'},
 {'id': '326', 'name': 'Texas State Bobcats'},
 {'id': '2653', 'name': 'Troy Trojans'},
 {'id': '2433', 'name': 'UL Monroe Warhawks'},
 {'id': '250', 'name': 'UT Arlington Mavericks'},
 {'id': '252', 'name': 'BYU Cougars'},
 {'id': '2250', 'name': 'Gonzaga Bulldogs'},
 {'id': '2351', 'name': 'Loyola Marymount Lions'},
 {'id': '279', 'name': 'Pacific Tigers'},
 {'id': '2492', 'name': 'Pepperdine Waves'},
 {'id': '2501', 'name': 'Portland Pilots'},
 {'id': '2608', 'name': "Saint Mary's Gaels"},
 {'id': '301', 'name': 'San Diego Toreros'},
 {'id': '2539', 'name': 'San Francisco Dons'},
 {'id': '2541', 'name': 'Santa Clara Broncos'},
 {'id': '2000', 'name': 'Abilene Christian Wildcats'},
 {'id': '2856', 'name': 'California Baptist Lancers'},
 {'id': '2130', 'name': 'Chicago State Cougars'},
 {'id': '3101', 'name': 'Dixie State Trailblazers'},
 {'id': '2253', 'name': 'Grand Canyon Antelopes'},
 {'id': '2320', 'name': 'Lamar Cardinals'},
 {'id': '166', 'name': 'New Mexico State Aggies'},
 {'id': '2534', 'name': 'Sam Houston Bearkats'},
 {'id': '2547', 'name': 'Seattle U Redhawks'},
 {'id': '2617', 'name': 'Stephen F. Austin Lumberjacks'},
 {'id': '2627', 'name': 'Tarleton Texans'},
 {'id': '292', 'name': 'UT Rio Grande Valley Vaqueros'},
 {'id': '3084', 'name': 'Utah Valley Wolverines'}]

import re
import json
from bs4 import BeautifulSoup
import urllib
from Team import Team, TeamGroup
from pprint import pprint
import requests
from pymongo import MongoClient
client = MongoClient('localhost', 27017)
db = client.ncaa
TEAMS = db.teams2

url_re = r'(\d+)'
stats_url = 'https://www.espn.com/mens-college-basketball/team/stats/_/id/{}/season/{}'
record_url = 'https://www.espn.com/mens-college-basketball/standings/_/season/{}'
STATS_CAT = ['NAME','GP','MIN','PTS','REB','AST','STL','BLK','TO','FG%','FT%','3P%',
             'total_NAME','total_MIN','total_FGM','total_FGA','total_FTM','total_FTA',
             'total_3PM','total_3PA','total_PTS','total_OR','total_DR','total_REB',
             'total_AST','total_TO','total_STL','total_BLK']


for year in range(2022,2023):
    for id_name in ids:
        print("Stats ==> " + stats_url.format(id_name['id'], str(year)))
        if TEAMS.find_one({'ID': id_name['id'] + str(year)}) == None:
            url_stat = requests.get(stats_url.format(id_name['id'], str(year)))
            stat = url_stat.text
            soup_stat = BeautifulSoup(stat, 'html.parser')
            total_stat = soup_stat.find_all('td',{'class':'Stats__TotalRow'})
            if len(total_stat) == 0:
                continue
            cats = []
            for t in total_stat:
                cats.append(t.find('span').text)

            meta = {
                'name': id_name['name'],
                'year': str(year),
                'stats': cats
            }
            team = Team(id_name['id'], meta)
            TEAMS.insert_one(team.to_dict())

for year in range(2022,2023):
    print("Record ==> " + record_url.format(str(year)))
    url_record = requests.get(record_url.format(str(year)))
    record = url_record.text
    soup_record = BeautifulSoup(record, 'html.parser')
    conferences = soup_record.find_all('div', {'class':'standings__table'})
    for conf in conferences:
        tables = conf.find_all('table')
        names_tab = tables[0]
        records_tab = tables[1]
        names = names_tab.find('tbody', {'class': 'Table__TBODY'}).find_all('tr')
        records = records_tab.find('tbody', {'class': 'Table__TBODY'}).find_all('tr')
        assert len(names) == len(records)
        for i in range(len(names)):
            name = names[i].find('span', {'class': 'hide-mobile'})
            if name != None:
                name = name.text
                # print(name)
                cats = records[i].find_all('td')
                overall = cats[3].text
                home = cats[5].text
                away = cats[6].text
                meta = {
                    'record': overall,
                    'home': home,
                    'away': away
                }
                # print(meta)
                TEAMS.update_one({'name': name, 'year': str(year)}, { '$set': { 'record': meta }})

bpi_url = 'https://www.espn.com/mens-college-basketball/bpi/_/view/overview/season/{}/page/{}'
for year in range(2022, 2023):
    for page in range(1,9):
        print("BPI ==> " + bpi_url.format(str(year), str(page)))
        bpi_req = requests.get(bpi_url.format(str(year), str(page))).text
        soup = BeautifulSoup(bpi_req, 'html.parser')
        bpi_table = soup.find('table', {'class': 'bpi__table'})
        if bpi_table != None:
            bpi_tbody = bpi_table.find('tbody')
            bpi_tr = bpi_table.find_all('tr')
            for rec in bpi_tr:
                bpi_td = rec.find_all('td')
                if len(bpi_td) > 0:
                    id_full = bpi_td[1].find('a', href=True)['href']
                    m = re.search(url_re, id_full)
                    if m:
                        id = m.group(1)
                        record = bpi_td[3].text
                        bpi = bpi_td[4].text
                        sos = bpi_td[5].text
                        sor = bpi_td[6].text
                        meta = {
                            'record': record,
                            'bpi': bpi,
                            'sos': sos,
                            'sor': sor
                        }

                        TEAMS.update_one({'id_num': id, 'year': str(year)}, {'$set': {'ranking': meta}})
            

